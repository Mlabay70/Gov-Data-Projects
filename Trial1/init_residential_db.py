import os
import sqlite3
import csv

def init_residential_db():
    db_path = 'residential_permits.db'
    csv_path = 'Residential_Construction_Permits_by_County_5026727375813176131 - Residential_Construction_Permits_by_County_5026727375813176131.csv.csv'
    conn = sqlite3.connect(db_path)
    c = conn.cursor()
    # Drop and recreate the permits table every time
    c.execute('DROP TABLE IF EXISTS permits')
    c.execute('''
                CREATE TABLE permits (
                    OBJECTID INTEGER,
                    GEOID TEXT,
                    STATE TEXT,
                    COUNTY TEXT,
                    NAME TEXT,
                    STUSAB TEXT,
                    STATE_NAME TEXT,
                    ALL_PERMITS_1980 INTEGER,
                    SINGLE_FAMILY_PERMITS_1980 INTEGER,
                    ALL_MULTIFAMILY_PERMITS_1980 INTEGER,
                    MULTIFAMILY_PERMITS_2_UNITS_1980 INTEGER,
                    MULTIFAMILY_PERMITS_3_4_UNITS_1980 INTEGER,
                    MULTIFAMILY_PERMITS_5_OR_MORE_UNITS_1980 INTEGER,
                    ALL_PERMITS_1981 INTEGER,
                    SINGLE_FAMILY_PERMITS_1981 INTEGER,
                    ALL_MULTIFAMILY_PERMITS_1981 INTEGER,
                    MULTIFAMILY_PERMITS_2_UNITS_1981 INTEGER,
                    MULTIFAMILY_PERMITS_3_4_UNITS_1981 INTEGER,
                    MULTIFAMILY_PERMITS_5_OR_MORE_UNITS_1981 INTEGER,
                    ALL_PERMITS_1982 INTEGER,
                    SINGLE_FAMILY_PERMITS_1982 INTEGER,
                    ALL_MULTIFAMILY_PERMITS_1982 INTEGER,
                    MULTIFAMILY_PERMITS_2_UNITS_1982 INTEGER,
                    MULTIFAMILY_PERMITS_3_4_UNITS_1982 INTEGER,
                    MULTIFAMILY_PERMITS_5_OR_MORE_UNITS_1982 INTEGER,
                    ALL_PERMITS_1983 INTEGER,
                    SINGLE_FAMILY_PERMITS_1983 INTEGER,
                    ALL_MULTIFAMILY_PERMITS_1983 INTEGER,
                    MULTIFAMILY_PERMITS_2_UNITS_1983 INTEGER,
                    MULTIFAMILY_PERMITS_3_4_UNITS_1983 INTEGER,
                    MULTIFAMILY_PERMITS_5_OR_MORE_UNITS_1983 INTEGER,
                    ALL_PERMITS_1984 INTEGER,
                    SINGLE_FAMILY_PERMITS_1984 INTEGER,
                    ALL_MULTIFAMILY_PERMITS_1984 INTEGER,
                    MULTIFAMILY_PERMITS_2_UNITS_1984 INTEGER,
                    MULTIFAMILY_PERMITS_3_4_UNITS_1984 INTEGER,
                    MULTIFAMILY_PERMITS_5_OR_MORE_UNITS_1984 INTEGER,
                    ALL_PERMITS_1985 INTEGER,
                    SINGLE_FAMILY_PERMITS_1985 INTEGER,
                    ALL_MULTIFAMILY_PERMITS_1985 INTEGER,
                    MULTIFAMILY_PERMITS_2_UNITS_1985 INTEGER,
                    MULTIFAMILY_PERMITS_3_4_UNITS_1985 INTEGER,
                    MULTIFAMILY_PERMITS_5_OR_MORE_UNITS_1985 INTEGER,
                    ALL_PERMITS_1986 INTEGER,
                    SINGLE_FAMILY_PERMITS_1986 INTEGER,
                    ALL_MULTIFAMILY_PERMITS_1986 INTEGER,
                    MULTIFAMILY_PERMITS_2_UNITS_1986 INTEGER,
                    MULTIFAMILY_PERMITS_3_4_UNITS_1986 INTEGER,
                    MULTIFAMILY_PERMITS_5_OR_MORE_UNITS_1986 INTEGER,
                    ALL_PERMITS_1987 INTEGER,
                    SINGLE_FAMILY_PERMITS_1987 INTEGER,
                    ALL_MULTIFAMILY_PERMITS_1987 INTEGER,
                    MULTIFAMILY_PERMITS_2_UNITS_1987 INTEGER,
                    MULTIFAMILY_PERMITS_3_4_UNITS_1987 INTEGER,
                    MULTIFAMILY_PERMITS_5_OR_MORE_UNITS_1987 INTEGER,
                    ALL_PERMITS_1988 INTEGER,
                    SINGLE_FAMILY_PERMITS_1988 INTEGER,
                    ALL_MULTIFAMILY_PERMITS_1988 INTEGER,
                    MULTIFAMILY_PERMITS_2_UNITS_1988 INTEGER,
                    MULTIFAMILY_PERMITS_3_4_UNITS_1988 INTEGER,
                    MULTIFAMILY_PERMITS_5_OR_MORE_UNITS_1988 INTEGER,
                    ALL_PERMITS_1989 INTEGER,
                    SINGLE_FAMILY_PERMITS_1989 INTEGER,
                    ALL_MULTIFAMILY_PERMITS_1989 INTEGER,
                    MULTIFAMILY_PERMITS_2_UNITS_1989 INTEGER,
                    MULTIFAMILY_PERMITS_3_4_UNITS_1989 INTEGER,
                    MULTIFAMILY_PERMITS_5_OR_MORE_UNITS_1989 INTEGER,
                    ALL_PERMITS_1990 INTEGER,
                    SINGLE_FAMILY_PERMITS_1990 INTEGER,
                    ALL_MULTIFAMILY_PERMITS_1990 INTEGER,
                    MULTIFAMILY_PERMITS_2_UNITS_1990 INTEGER,
                    MULTIFAMILY_PERMITS_3_4_UNITS_1990 INTEGER,
                    MULTIFAMILY_PERMITS_5_OR_MORE_UNITS_1990 INTEGER,
                    ALL_PERMITS_1991 INTEGER,
                    SINGLE_FAMILY_PERMITS_1991 INTEGER,
                    ALL_MULTIFAMILY_PERMITS_1991 INTEGER,
                    MULTIFAMILY_PERMITS_2_UNITS_1991 INTEGER,
                    MULTIFAMILY_PERMITS_3_4_UNITS_1991 INTEGER,
                    MULTIFAMILY_PERMITS_5_OR_MORE_UNITS_1991 INTEGER,
                    ALL_PERMITS_1992 INTEGER,
                    SINGLE_FAMILY_PERMITS_1992 INTEGER,
                    ALL_MULTIFAMILY_PERMITS_1992 INTEGER,
                    MULTIFAMILY_PERMITS_2_UNITS_1992 INTEGER,
                    MULTIFAMILY_PERMITS_3_4_UNITS_1992 INTEGER,
                    MULTIFAMILY_PERMITS_5_OR_MORE_UNITS_1992 INTEGER,
                    ALL_PERMITS_1993 INTEGER,
                    SINGLE_FAMILY_PERMITS_1993 INTEGER,
                    ALL_MULTIFAMILY_PERMITS_1993 INTEGER,
                    MULTIFAMILY_PERMITS_2_UNITS_1993 INTEGER,
                    MULTIFAMILY_PERMITS_3_4_UNITS_1993 INTEGER,
                    MULTIFAMILY_PERMITS_5_OR_MORE_UNITS_1993 INTEGER,
                    ALL_PERMITS_1994 INTEGER,
                    SINGLE_FAMILY_PERMITS_1994 INTEGER,
                    ALL_MULTIFAMILY_PERMITS_1994 INTEGER,
                    MULTIFAMILY_PERMITS_2_UNITS_1994 INTEGER,
                    MULTIFAMILY_PERMITS_3_4_UNITS_1994 INTEGER,
                    MULTIFAMILY_PERMITS_5_OR_MORE_UNITS_1994 INTEGER,
                    ALL_PERMITS_1995 INTEGER,
                    SINGLE_FAMILY_PERMITS_1995 INTEGER,
                    ALL_MULTIFAMILY_PERMITS_1995 INTEGER,
                    MULTIFAMILY_PERMITS_2_UNITS_1995 INTEGER,
                    MULTIFAMILY_PERMITS_3_4_UNITS_1995 INTEGER,
                    MULTIFAMILY_PERMITS_5_OR_MORE_UNITS_1995 INTEGER,
                    ALL_PERMITS_1996 INTEGER,
                    SINGLE_FAMILY_PERMITS_1996 INTEGER,
                    ALL_MULTIFAMILY_PERMITS_1996 INTEGER,
                    MULTIFAMILY_PERMITS_2_UNITS_1996 INTEGER,
                    MULTIFAMILY_PERMITS_3_4_UNITS_1996 INTEGER,
                    MULTIFAMILY_PERMITS_5_OR_MORE_UNITS_1996 INTEGER,
                    ALL_PERMITS_1997 INTEGER,
                    SINGLE_FAMILY_PERMITS_1997 INTEGER,
                    ALL_MULTIFAMILY_PERMITS_1997 INTEGER,
                    MULTIFAMILY_PERMITS_2_UNITS_1997 INTEGER,
                    MULTIFAMILY_PERMITS_3_4_UNITS_1997 INTEGER,
                    MULTIFAMILY_PERMITS_5_OR_MORE_UNITS_1997 INTEGER,
                    ALL_PERMITS_1998 INTEGER,
                    SINGLE_FAMILY_PERMITS_1998 INTEGER,
                    ALL_MULTIFAMILY_PERMITS_1998 INTEGER,
                    MULTIFAMILY_PERMITS_2_UNITS_1998 INTEGER,
                    MULTIFAMILY_PERMITS_3_4_UNITS_1998 INTEGER,
                    MULTIFAMILY_PERMITS_5_OR_MORE_UNITS_1998 INTEGER,
                    ALL_PERMITS_1999 INTEGER,
                    SINGLE_FAMILY_PERMITS_1999 INTEGER,
                    ALL_MULTIFAMILY_PERMITS_1999 INTEGER,
                    MULTIFAMILY_PERMITS_2_UNITS_1999 INTEGER,
                    MULTIFAMILY_PERMITS_3_4_UNITS_1999 INTEGER,
                    MULTIFAMILY_PERMITS_5_OR_MORE_UNITS_1999 INTEGER,
                    ALL_PERMITS_2000 INTEGER,
                    SINGLE_FAMILY_PERMITS_2000 INTEGER,
                    ALL_MULTIFAMILY_PERMITS_2000 INTEGER,
                    MULTIFAMILY_PERMITS_2_UNITS_2000 INTEGER,
                    MULTIFAMILY_PERMITS_3_4_UNITS_2000 INTEGER,
                    MULTIFAMILY_PERMITS_5_OR_MORE_UNITS_2000 INTEGER,
                    ALL_PERMITS_2001 INTEGER,
                    SINGLE_FAMILY_PERMITS_2001 INTEGER,
                    ALL_MULTIFAMILY_PERMITS_2001 INTEGER,
                    MULTIFAMILY_PERMITS_2_UNITS_2001 INTEGER,
                    MULTIFAMILY_PERMITS_3_4_UNITS_2001 INTEGER,
                    MULTIFAMILY_PERMITS_5_OR_MORE_UNITS_2001 INTEGER,
                    ALL_PERMITS_2002 INTEGER,
                    SINGLE_FAMILY_PERMITS_2002 INTEGER,
                    ALL_MULTIFAMILY_PERMITS_2002 INTEGER,
                    MULTIFAMILY_PERMITS_2_UNITS_2002 INTEGER,
                    MULTIFAMILY_PERMITS_3_4_UNITS_2002 INTEGER,
                    MULTIFAMILY_PERMITS_5_OR_MORE_UNITS_2002 INTEGER,
                    ALL_PERMITS_2003 INTEGER,
                    SINGLE_FAMILY_PERMITS_2003 INTEGER,
                    ALL_MULTIFAMILY_PERMITS_2003 INTEGER,
                    MULTIFAMILY_PERMITS_2_UNITS_2003 INTEGER,
                    MULTIFAMILY_PERMITS_3_4_UNITS_2003 INTEGER,
                    MULTIFAMILY_PERMITS_5_OR_MORE_UNITS_2003 INTEGER,
                    ALL_PERMITS_2004 INTEGER,
                    SINGLE_FAMILY_PERMITS_2004 INTEGER,
                    ALL_MULTIFAMILY_PERMITS_2004 INTEGER,
                    MULTIFAMILY_PERMITS_2_UNITS_2004 INTEGER,
                    MULTIFAMILY_PERMITS_3_4_UNITS_2004 INTEGER,
                    MULTIFAMILY_PERMITS_5_OR_MORE_UNITS_2004 INTEGER,
                    ALL_PERMITS_2005 INTEGER,
                    SINGLE_FAMILY_PERMITS_2005 INTEGER,
                    ALL_MULTIFAMILY_PERMITS_2005 INTEGER,
                    MULTIFAMILY_PERMITS_2_UNITS_2005 INTEGER,
                    MULTIFAMILY_PERMITS_3_4_UNITS_2005 INTEGER,
                    MULTIFAMILY_PERMITS_5_OR_MORE_UNITS_2005 INTEGER,
                    ALL_PERMITS_2006 INTEGER,
                    SINGLE_FAMILY_PERMITS_2006 INTEGER,
                    ALL_MULTIFAMILY_PERMITS_2006 INTEGER,
                    MULTIFAMILY_PERMITS_2_UNITS_2006 INTEGER,
                    MULTIFAMILY_PERMITS_3_4_UNITS_2006 INTEGER,
                    MULTIFAMILY_PERMITS_5_OR_MORE_UNITS_2006 INTEGER,
                    ALL_PERMITS_2007 INTEGER,
                    SINGLE_FAMILY_PERMITS_2007 INTEGER,
                    ALL_MULTIFAMILY_PERMITS_2007 INTEGER,
                    MULTIFAMILY_PERMITS_2_UNITS_2007 INTEGER,
                    MULTIFAMILY_PERMITS_3_4_UNITS_2007 INTEGER,
                    MULTIFAMILY_PERMITS_5_OR_MORE_UNITS_2007 INTEGER,
                    ALL_PERMITS_2008 INTEGER,
                    SINGLE_FAMILY_PERMITS_2008 INTEGER,
                    ALL_MULTIFAMILY_PERMITS_2008 INTEGER,
                    MULTIFAMILY_PERMITS_2_UNITS_2008 INTEGER,
                    MULTIFAMILY_PERMITS_3_4_UNITS_2008 INTEGER,
                    MULTIFAMILY_PERMITS_5_OR_MORE_UNITS_2008 INTEGER,
                    ALL_PERMITS_2009 INTEGER,
                    SINGLE_FAMILY_PERMITS_2009 INTEGER,
                    ALL_MULTIFAMILY_PERMITS_2009 INTEGER,
                    MULTIFAMILY_PERMITS_2_UNITS_2009 INTEGER,
                    MULTIFAMILY_PERMITS_3_4_UNITS_2009 INTEGER,
                    MULTIFAMILY_PERMITS_5_OR_MORE_UNITS_2009 INTEGER,
                    ALL_PERMITS_2010 INTEGER,
                    SINGLE_FAMILY_PERMITS_2010 INTEGER,
                    ALL_MULTIFAMILY_PERMITS_2010 INTEGER,
                    MULTIFAMILY_PERMITS_2_UNITS_2010 INTEGER,
                    MULTIFAMILY_PERMITS_3_4_UNITS_2010 INTEGER,
                    MULTIFAMILY_PERMITS_5_OR_MORE_UNITS_2010 INTEGER,
                    ALL_PERMITS_2011 INTEGER,
                    SINGLE_FAMILY_PERMITS_2011 INTEGER,
                    ALL_MULTIFAMILY_PERMITS_2011 INTEGER,
                    MULTIFAMILY_PERMITS_2_UNITS_2011 INTEGER,
                    MULTIFAMILY_PERMITS_3_4_UNITS_2011 INTEGER,
                    MULTIFAMILY_PERMITS_5_OR_MORE_UNITS_2011 INTEGER,
                    ALL_PERMITS_2012 INTEGER,
                    SINGLE_FAMILY_PERMITS_2012 INTEGER,
                    ALL_MULTIFAMILY_PERMITS_2012 INTEGER,
                    MULTIFAMILY_PERMITS_2_UNITS_2012 INTEGER,
                    MULTIFAMILY_PERMITS_3_4_UNITS_2012 INTEGER,
                    MULTIFAMILY_PERMITS_5_OR_MORE_UNITS_2012 INTEGER,
                    ALL_PERMITS_2013 INTEGER,
                    SINGLE_FAMILY_PERMITS_2013 INTEGER,
                    ALL_MULTIFAMILY_PERMITS_2013 INTEGER,
                    MULTIFAMILY_PERMITS_2_UNITS_2013 INTEGER,
                    MULTIFAMILY_PERMITS_3_4_UNITS_2013 INTEGER,
                    MULTIFAMILY_PERMITS_5_OR_MORE_UNITS_2013 INTEGER,
                    ALL_PERMITS_2014 INTEGER,
                    SINGLE_FAMILY_PERMITS_2014 INTEGER,
                    ALL_MULTIFAMILY_PERMITS_2014 INTEGER,
                    MULTIFAMILY_PERMITS_2_UNITS_2014 INTEGER,
                    MULTIFAMILY_PERMITS_3_4_UNITS_2014 INTEGER,
                    MULTIFAMILY_PERMITS_5_OR_MORE_UNITS_2014 INTEGER,
                    ALL_PERMITS_2015 INTEGER,
                    SINGLE_FAMILY_PERMITS_2015 INTEGER,
                    ALL_MULTIFAMILY_PERMITS_2015 INTEGER,
                    MULTIFAMILY_PERMITS_2_UNITS_2015 INTEGER,
                    MULTIFAMILY_PERMITS_3_4_UNITS_2015 INTEGER,
                    MULTIFAMILY_PERMITS_5_OR_MORE_UNITS_2015 INTEGER,
                    ALL_PERMITS_2016 INTEGER,
                    SINGLE_FAMILY_PERMITS_2016 INTEGER,
                    ALL_MULTIFAMILY_PERMITS_2016 INTEGER,
                    MULTIFAMILY_PERMITS_2_UNITS_2016 INTEGER,
                    MULTIFAMILY_PERMITS_3_4_UNITS_2016 INTEGER,
                    MULTIFAMILY_PERMITS_5_OR_MORE_UNITS_2016 INTEGER,
                    ALL_PERMITS_2017 INTEGER,
                    SINGLE_FAMILY_PERMITS_2017 INTEGER,
                    ALL_MULTIFAMILY_PERMITS_2017 INTEGER,
                    MULTIFAMILY_PERMITS_2_UNITS_2017 INTEGER,
                    MULTIFAMILY_PERMITS_3_4_UNITS_2017 INTEGER,
                    MULTIFAMILY_PERMITS_5_OR_MORE_UNITS_2017 INTEGER,
                    ALL_PERMITS_2018 INTEGER,
                    SINGLE_FAMILY_PERMITS_2018 INTEGER,
                    ALL_MULTIFAMILY_PERMITS_2018 INTEGER,
                    MULTIFAMILY_PERMITS_2_UNITS_2018 INTEGER,
                    MULTIFAMILY_PERMITS_3_4_UNITS_2018 INTEGER,
                    MULTIFAMILY_PERMITS_5_OR_MORE_UNITS_2018 INTEGER,
                    ALL_PERMITS_2019 INTEGER,
                    SINGLE_FAMILY_PERMITS_2019 INTEGER,
                    ALL_MULTIFAMILY_PERMITS_2019 INTEGER,
                    MULTIFAMILY_PERMITS_2_UNITS_2019 INTEGER,
                    MULTIFAMILY_PERMITS_3_4_UNITS_2019 INTEGER,
                    MULTIFAMILY_PERMITS_5_OR_MORE_UNITS_2019 INTEGER,
                    ALL_PERMITS_2020 INTEGER,
                    SINGLE_FAMILY_PERMITS_2020 INTEGER,
                    ALL_MULTIFAMILY_PERMITS_2020 INTEGER,
                    MULTIFAMILY_PERMITS_2_UNITS_2020 INTEGER,
                    MULTIFAMILY_PERMITS_3_4_UNITS_2020 INTEGER,
                    MULTIFAMILY_PERMITS_5_OR_MORE_UNITS_2020 INTEGER,
                    ALL_PERMITS_2021 INTEGER,
                    SINGLE_FAMILY_PERMITS_2021 INTEGER,
                    ALL_MULTIFAMILY_PERMITS_2021 INTEGER,
                    MULTIFAMILY_PERMITS_2_UNITS_2021 INTEGER,
                    MULTIFAMILY_PERMITS_3_4_UNITS_2021 INTEGER,
                    MULTIFAMILY_PERMITS_5_OR_MORE_UNITS_2021 INTEGER,
                    ALL_PERMITS_2022 INTEGER,
                    SINGLE_FAMILY_PERMITS_2022 INTEGER,
                    ALL_MULTIFAMILY_PERMITS_2022 INTEGER,
                    MULTIFAMILY_PERMITS_2_UNITS_2022 INTEGER,
                    MULTIFAMILY_PERMITS_3_4_UNIT_2022 INTEGER,
                    MULTIFAMILY_PERMITS_5_OR_MORE_2022 INTEGER,
                    Shape__Area INTEGER,
                    Shape__Length INTEGER
                )
            ''')
    # Read CSV and insert rows
    with open(csv_path, newline='', encoding='utf-8') as csvfile:
        reader = csv.DictReader(csvfile)
        columns = reader.fieldnames
        placeholders = ','.join(['?'] * len(columns))
        insert_sql = f"INSERT INTO permits ({','.join(columns)}) VALUES ({placeholders})"
        for row in reader:
            values = [row[col] for col in columns]
            c.execute(insert_sql, values)
    conn.commit()
    conn.close()
